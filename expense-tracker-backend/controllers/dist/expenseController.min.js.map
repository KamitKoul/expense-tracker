{"version":3,"sources":["expenseController.js"],"names":["mongoose","require","Expense","User","req","res","_req$body","userId","title","amount","category","expenseDate","expense","regeneratorRuntime","async","_context","prev","next","body","createExpense","abrupt","status","json","message","awrap","findById","sent","create","t0","error","stop","getExpensesByUser","expenses","_context2","params","find","sort","query","year","month","startDate","Date","endDate","aggregate","$gte","$lt","$group","_id","totalAmount","$sum","result","_context3","getCategorySummary","summary","_context4","$match","Types","ObjectId","totalSpent","$sort","module","exports","getMonthlyTotal"],"mappings":"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","file":"expenseController.min.js","sourcesContent":["const mongoose = require(\"mongoose\");\r\nconst Expense = require(\"../models/Expense\");\r\nconst User = require(\"../models/User\");\r\n\r\n// @desc   Create new expense\r\n// @route  POST /api/expenses\r\nconst createExpense = async (req, res) => {\r\n  try {\r\n    const { userId, title, amount, category, expenseDate } = req.body;\r\n\r\n    if (!userId || !title || !amount || !category || !expenseDate) {\r\n      return res.status(400).json({ message: \"All fields are required\" });\r\n    }\r\n\r\n    const userExists = await User.findById(userId);\r\n    if (!userExists) {\r\n      return res.status(404).json({ message: \"User not found\" });\r\n    }\r\n\r\n    const expense = await Expense.create({\r\n      userId,\r\n      title,\r\n      amount,\r\n      category,\r\n      expenseDate\r\n    });\r\n\r\n    res.status(201).json(expense);\r\n  } catch (error) {\r\n    res.status(500).json({ error: error.message });\r\n  }\r\n};\r\n\r\n// @desc   Get all expenses for a user\r\n// @route  GET /api/expenses/user/:userId\r\nconst getExpensesByUser = async (req, res) => {\r\n  try {\r\n    const { userId } = req.params;\r\n\r\n    const expenses = await Expense.find({ userId })\r\n      .sort({ expenseDate: -1 });\r\n\r\n    res.json(expenses);\r\n  } catch (error) {\r\n    res.status(500).json({ error: error.message });\r\n  }\r\n};\r\n\r\n// @desc   Get total expenses for a user in a month\r\n// @route  GET /api/expenses/user/:userId/monthly\r\nconst getMonthlyTotal = async (req, res) => {\r\n  try {\r\n    const { userId } = req.params;\r\n    const { year, month } = req.query;\r\n\r\n    if (!year || !month) {\r\n      return res.status(400).json({ message: \"Year and month are required\" });\r\n    }\r\n\r\n    const startDate = new Date(year, month - 1, 1);\r\n    const endDate = new Date(year, month, 1);\r\n\r\n    const result = await Expense.aggregate([\r\n      {\r\n        $match: {\r\n          userId: new mongoose.Types.ObjectId(userId),\r\n          expenseDate: { $gte: startDate, $lt: endDate }\r\n        }\r\n      },\r\n      {\r\n        $group: {\r\n          _id: null,\r\n          totalAmount: { $sum: \"$amount\" }\r\n        }\r\n      }\r\n    ]);\r\n\r\n    res.json({\r\n      total: result.length > 0 ? result[0].totalAmount : 0\r\n    });\r\n  } catch (error) {\r\n    res.status(500).json({ error: error.message });\r\n  }\r\n};\r\n\r\n// @desc   Category-wise expense summary\r\n// @route  GET /api/expenses/user/:userId/category-summary\r\nconst getCategorySummary = async (req, res) => {\r\n  try {\r\n    const { userId } = req.params;\r\n\r\n    const summary = await Expense.aggregate([\r\n      {\r\n        $match: {\r\n          userId: new mongoose.Types.ObjectId(userId)\r\n        }\r\n      },\r\n      {\r\n        $group: {\r\n          _id: \"$category\",\r\n          totalSpent: { $sum: \"$amount\" }\r\n        }\r\n      },\r\n      {\r\n        $sort: { totalSpent: -1 }\r\n      }\r\n    ]);\r\n\r\n    res.json(summary);\r\n  } catch (error) {\r\n    res.status(500).json({ error: error.message });\r\n  }\r\n};\r\n\r\nmodule.exports = {\r\n  createExpense,\r\n  getExpensesByUser,\r\n  getMonthlyTotal,\r\n  getCategorySummary\r\n};\r\n"]}