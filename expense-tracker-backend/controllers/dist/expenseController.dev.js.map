{"version":3,"sources":["expenseController.js"],"names":["mongoose","require","Expense","User","createExpense","req","res","body","userId","title","amount","category","expenseDate","status","json","message","findById","userExists","create","expense","error","getExpensesByUser","params","find","sort","expenses","getMonthlyTotal","query","year","month","startDate","Date","endDate","aggregate","$match","Types","ObjectId","$gte","$lt","$group","_id","totalAmount","$sum","result","total","length","getCategorySummary","totalSpent","$sort","summary","module","exports"],"mappings":";;AAAA,IAAMA,QAAQ,GAAGC,OAAO,CAAC,UAAD,CAAxB;;AACA,IAAMC,OAAO,GAAGD,OAAO,CAAC,mBAAD,CAAvB;;AACA,IAAME,IAAI,GAAGF,OAAO,CAAC,gBAAD,CAApB,C,CAEA;AACA;;;AACA,IAAMG,aAAa,GAAG,SAAhBA,aAAgB,CAAOC,GAAP,EAAYC,GAAZ;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,sBAEuCD,GAAG,CAACE,IAF3C,EAEVC,MAFU,aAEVA,MAFU,EAEFC,KAFE,aAEFA,KAFE,EAEKC,MAFL,aAEKA,MAFL,EAEaC,QAFb,aAEaA,QAFb,EAEuBC,WAFvB,aAEuBA,WAFvB;;AAAA,gBAId,CAACJ,MAAD,IAAW,CAACC,KAAZ,IAAqB,CAACC,MAAtB,IAAgC,CAACC,QAAjC,IAA6C,CAACC,WAJhC;AAAA;AAAA;AAAA;;AAAA,2CAKTN,GAAG,CAACO,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AAAEC,YAAAA,OAAO,EAAE;AAAX,WAArB,CALS;;AAAA;AAAA;AAAA,0CAQOZ,IAAI,CAACa,QAAL,CAAcR,MAAd,CARP;;AAAA;AAQZS,UAAAA,UARY;;AAAA,cASbA,UATa;AAAA;AAAA;AAAA;;AAAA,2CAUTX,GAAG,CAACO,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AAAEC,YAAAA,OAAO,EAAE;AAAX,WAArB,CAVS;;AAAA;AAAA;AAAA,0CAaIb,OAAO,CAACgB,MAAR,CAAe;AACnCV,YAAAA,MAAM,EAANA,MADmC;AAEnCC,YAAAA,KAAK,EAALA,KAFmC;AAGnCC,YAAAA,MAAM,EAANA,MAHmC;AAInCC,YAAAA,QAAQ,EAARA,QAJmC;AAKnCC,YAAAA,WAAW,EAAXA;AALmC,WAAf,CAbJ;;AAAA;AAaZO,UAAAA,OAbY;AAqBlBb,UAAAA,GAAG,CAACO,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqBK,OAArB;AArBkB;AAAA;;AAAA;AAAA;AAAA;AAuBlBb,UAAAA,GAAG,CAACO,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AAAEM,YAAAA,KAAK,EAAE,YAAML;AAAf,WAArB;;AAvBkB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,CAAtB,C,CA2BA;AACA;;;AACA,IAAMM,iBAAiB,GAAG,SAApBA,iBAAoB,CAAOhB,GAAP,EAAYC,GAAZ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEdE,UAAAA,MAFc,GAEHH,GAAG,CAACiB,MAFD,CAEdd,MAFc;AAAA;AAAA,0CAICN,OAAO,CAACqB,IAAR,CAAa;AAAEf,YAAAA,MAAM,EAANA;AAAF,WAAb,EACpBgB,IADoB,CACf;AAAEZ,YAAAA,WAAW,EAAE,CAAC;AAAhB,WADe,CAJD;;AAAA;AAIhBa,UAAAA,QAJgB;AAOtBnB,UAAAA,GAAG,CAACQ,IAAJ,CAASW,QAAT;AAPsB;AAAA;;AAAA;AAAA;AAAA;AAStBnB,UAAAA,GAAG,CAACO,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AAAEM,YAAAA,KAAK,EAAE,aAAML;AAAf,WAArB;;AATsB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,CAA1B,C,CAaA;AACA;;;AACA,IAAMW,eAAe,GAAG,SAAlBA,eAAkB,CAAOrB,GAAP,EAAYC,GAAZ;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAEZE,UAAAA,MAFY,GAEDH,GAAG,CAACiB,MAFH,CAEZd,MAFY;AAAA,uBAGIH,GAAG,CAACsB,KAHR,EAGZC,IAHY,cAGZA,IAHY,EAGNC,KAHM,cAGNA,KAHM;;AAAA,gBAKhB,CAACD,IAAD,IAAS,CAACC,KALM;AAAA;AAAA;AAAA;;AAAA,4CAMXvB,GAAG,CAACO,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AAAEC,YAAAA,OAAO,EAAE;AAAX,WAArB,CANW;;AAAA;AASde,UAAAA,SATc,GASF,IAAIC,IAAJ,CAASH,IAAT,EAAeC,KAAK,GAAG,CAAvB,EAA0B,CAA1B,CATE;AAUdG,UAAAA,OAVc,GAUJ,IAAID,IAAJ,CAASH,IAAT,EAAeC,KAAf,EAAsB,CAAtB,CAVI;AAAA;AAAA,0CAYC3B,OAAO,CAAC+B,SAAR,CAAkB,CACrC;AACEC,YAAAA,MAAM,EAAE;AACN1B,cAAAA,MAAM,EAAE,IAAIR,QAAQ,CAACmC,KAAT,CAAeC,QAAnB,CAA4B5B,MAA5B,CADF;AAENI,cAAAA,WAAW,EAAE;AAAEyB,gBAAAA,IAAI,EAAEP,SAAR;AAAmBQ,gBAAAA,GAAG,EAAEN;AAAxB;AAFP;AADV,WADqC,EAOrC;AACEO,YAAAA,MAAM,EAAE;AACNC,cAAAA,GAAG,EAAE,IADC;AAENC,cAAAA,WAAW,EAAE;AAAEC,gBAAAA,IAAI,EAAE;AAAR;AAFP;AADV,WAPqC,CAAlB,CAZD;;AAAA;AAYdC,UAAAA,MAZc;AA2BpBrC,UAAAA,GAAG,CAACQ,IAAJ,CAAS;AACP8B,YAAAA,KAAK,EAAED,MAAM,CAACE,MAAP,GAAgB,CAAhB,GAAoBF,MAAM,CAAC,CAAD,CAAN,CAAUF,WAA9B,GAA4C;AAD5C,WAAT;AA3BoB;AAAA;;AAAA;AAAA;AAAA;AA+BpBnC,UAAAA,GAAG,CAACO,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AAAEM,YAAAA,KAAK,EAAE,aAAML;AAAf,WAArB;;AA/BoB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,CAAxB,C,CAmCA;AACA;;;AACA,IAAM+B,kBAAkB,GAAG,SAArBA,kBAAqB,CAAOzC,GAAP,EAAYC,GAAZ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEfE,UAAAA,MAFe,GAEJH,GAAG,CAACiB,MAFA,CAEfd,MAFe;AAAA;AAAA,0CAIDN,OAAO,CAAC+B,SAAR,CAAkB,CACtC;AACEC,YAAAA,MAAM,EAAE;AACN1B,cAAAA,MAAM,EAAE,IAAIR,QAAQ,CAACmC,KAAT,CAAeC,QAAnB,CAA4B5B,MAA5B;AADF;AADV,WADsC,EAMtC;AACE+B,YAAAA,MAAM,EAAE;AACNC,cAAAA,GAAG,EAAE,WADC;AAENO,cAAAA,UAAU,EAAE;AAAEL,gBAAAA,IAAI,EAAE;AAAR;AAFN;AADV,WANsC,EAYtC;AACEM,YAAAA,KAAK,EAAE;AAAED,cAAAA,UAAU,EAAE,CAAC;AAAf;AADT,WAZsC,CAAlB,CAJC;;AAAA;AAIjBE,UAAAA,OAJiB;AAqBvB3C,UAAAA,GAAG,CAACQ,IAAJ,CAASmC,OAAT;AArBuB;AAAA;;AAAA;AAAA;AAAA;AAuBvB3C,UAAAA,GAAG,CAACO,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AAAEM,YAAAA,KAAK,EAAE,aAAML;AAAf,WAArB;;AAvBuB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,CAA3B;;AA2BAmC,MAAM,CAACC,OAAP,GAAiB;AACf/C,EAAAA,aAAa,EAAbA,aADe;AAEfiB,EAAAA,iBAAiB,EAAjBA,iBAFe;AAGfK,EAAAA,eAAe,EAAfA,eAHe;AAIfoB,EAAAA,kBAAkB,EAAlBA;AAJe,CAAjB","sourcesContent":["const mongoose = require(\"mongoose\");\r\nconst Expense = require(\"../models/Expense\");\r\nconst User = require(\"../models/User\");\r\n\r\n// @desc   Create new expense\r\n// @route  POST /api/expenses\r\nconst createExpense = async (req, res) => {\r\n  try {\r\n    const { userId, title, amount, category, expenseDate } = req.body;\r\n\r\n    if (!userId || !title || !amount || !category || !expenseDate) {\r\n      return res.status(400).json({ message: \"All fields are required\" });\r\n    }\r\n\r\n    const userExists = await User.findById(userId);\r\n    if (!userExists) {\r\n      return res.status(404).json({ message: \"User not found\" });\r\n    }\r\n\r\n    const expense = await Expense.create({\r\n      userId,\r\n      title,\r\n      amount,\r\n      category,\r\n      expenseDate\r\n    });\r\n\r\n    res.status(201).json(expense);\r\n  } catch (error) {\r\n    res.status(500).json({ error: error.message });\r\n  }\r\n};\r\n\r\n// @desc   Get all expenses for a user\r\n// @route  GET /api/expenses/user/:userId\r\nconst getExpensesByUser = async (req, res) => {\r\n  try {\r\n    const { userId } = req.params;\r\n\r\n    const expenses = await Expense.find({ userId })\r\n      .sort({ expenseDate: -1 });\r\n\r\n    res.json(expenses);\r\n  } catch (error) {\r\n    res.status(500).json({ error: error.message });\r\n  }\r\n};\r\n\r\n// @desc   Get total expenses for a user in a month\r\n// @route  GET /api/expenses/user/:userId/monthly\r\nconst getMonthlyTotal = async (req, res) => {\r\n  try {\r\n    const { userId } = req.params;\r\n    const { year, month } = req.query;\r\n\r\n    if (!year || !month) {\r\n      return res.status(400).json({ message: \"Year and month are required\" });\r\n    }\r\n\r\n    const startDate = new Date(year, month - 1, 1);\r\n    const endDate = new Date(year, month, 1);\r\n\r\n    const result = await Expense.aggregate([\r\n      {\r\n        $match: {\r\n          userId: new mongoose.Types.ObjectId(userId),\r\n          expenseDate: { $gte: startDate, $lt: endDate }\r\n        }\r\n      },\r\n      {\r\n        $group: {\r\n          _id: null,\r\n          totalAmount: { $sum: \"$amount\" }\r\n        }\r\n      }\r\n    ]);\r\n\r\n    res.json({\r\n      total: result.length > 0 ? result[0].totalAmount : 0\r\n    });\r\n  } catch (error) {\r\n    res.status(500).json({ error: error.message });\r\n  }\r\n};\r\n\r\n// @desc   Category-wise expense summary\r\n// @route  GET /api/expenses/user/:userId/category-summary\r\nconst getCategorySummary = async (req, res) => {\r\n  try {\r\n    const { userId } = req.params;\r\n\r\n    const summary = await Expense.aggregate([\r\n      {\r\n        $match: {\r\n          userId: new mongoose.Types.ObjectId(userId)\r\n        }\r\n      },\r\n      {\r\n        $group: {\r\n          _id: \"$category\",\r\n          totalSpent: { $sum: \"$amount\" }\r\n        }\r\n      },\r\n      {\r\n        $sort: { totalSpent: -1 }\r\n      }\r\n    ]);\r\n\r\n    res.json(summary);\r\n  } catch (error) {\r\n    res.status(500).json({ error: error.message });\r\n  }\r\n};\r\n\r\nmodule.exports = {\r\n  createExpense,\r\n  getExpensesByUser,\r\n  getMonthlyTotal,\r\n  getCategorySummary\r\n};\r\n"],"file":"expenseController.dev.js"}